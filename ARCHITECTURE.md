# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ cookies

## –û–±–∑–æ—Ä

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    SecBrain YouTube Downloader                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ     ProductionYouTubeGrabber V2         ‚îÇ
        ‚îÇ  (youtube_grabber_v2.py)                ‚îÇ
        ‚îÇ                                         ‚îÇ
        ‚îÇ  ‚Ä¢ @rate_limit decorator                ‚îÇ
        ‚îÇ  ‚Ä¢ @smart_retry decorator               ‚îÇ
        ‚îÇ  ‚Ä¢ Client rotation (WEB/ANDROID/IOS)    ‚îÇ
        ‚îÇ  ‚Ä¢ Health-based cookie selection        ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                     ‚îÇ           ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                                        ‚îÇ
        ‚ñº                                        ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ImprovedCookieManager‚îÇ              ‚îÇ   yt-dlp CLI         ‚îÇ
‚îÇ (cookie_manager.py)  ‚îÇ              ‚îÇ                      ‚îÇ
‚îÇ                      ‚îÇ              ‚îÇ  ‚Ä¢ User-Agent        ‚îÇ
‚îÇ  ‚Ä¢ Health scoring    ‚îÇ              ‚îÇ  ‚Ä¢ Custom headers    ‚îÇ
‚îÇ  ‚Ä¢ Auto-blocking     ‚îÇ              ‚îÇ  ‚Ä¢ Cookies file      ‚îÇ
‚îÇ  ‚Ä¢ Usage tracking    ‚îÇ              ‚îÇ  ‚Ä¢ Rate limiting     ‚îÇ
‚îÇ  ‚Ä¢ Statistics        ‚îÇ              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    cookies/         ‚îÇ
‚îÇ                     ‚îÇ
‚îÇ  ‚Ä¢ account1.txt     ‚îÇ
‚îÇ  ‚Ä¢ account2.txt     ‚îÇ
‚îÇ  ‚Ä¢ account3.txt     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. ProductionYouTubeGrabber V2 (–ì–ª–∞–≤–Ω—ã–π)

**–§–∞–π–ª:** `src/modules/youtube_grabber_v2.py` (18 KB)

**–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:**
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
- Rate limiting —á–µ—Ä–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã
- Retry –ª–æ–≥–∏–∫–∞ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- Client rotation (WEB/ANDROID/IOS)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å yt-dlp

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**
```python
@rate_limit(calls=1, period=2.0)
@smart_retry(max_attempts=4, base_delay=2.0)
def get_metadata(url: str) -> Dict
    """–ü–æ–ª—É—á–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Å retry –∏ rate limiting"""

@rate_limit(calls=1, period=3.0)
@smart_retry(max_attempts=3, base_delay=3.0)
def download_video(url: str, quality: str) -> Path
    """–°–∫–∞—á–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫"""
```

**–î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã:**
- `@rate_limit`: –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ (–≤–∑—è—Ç–æ –∏–∑ Hitomi-Downloader)
- `@smart_retry`: –£–º–Ω—ã–π retry —Å jitter (–≤–∑—è—Ç–æ –∏–∑ youtube-dl + —É–ª—É—á—à–µ–Ω–∏—è)

### 2. ImprovedCookieManager (Cookie —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

**–§–∞–π–ª:** `cookie_manager.py` (9.3 KB)

**–û–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏:**
- –•—Ä–∞–Ω–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö cookies
- Health scoring (—á–µ–º –Ω–∏–∂–µ, —Ç–µ–º –ª—É—á—à–µ)
- –ê–≤—Ç–æ–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**Health Score —Ñ–æ—Ä–º—É–ª–∞:**
```python
health_score = usage_count * 10 + fail_count * 100
```

**–ü—Ä–∏–º–µ—Ä:**
```
Cookie A: usage=5, fail=0  ‚Üí score=50  ‚úÖ (–ª—É—á—à–µ)
Cookie B: usage=10, fail=2 ‚Üí score=300 ‚ùå (—Ö—É–∂–µ)
```

**–õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞:**
1. –§–∏–ª—å—Ç—Ä—É–µ–º –Ω–µ–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
2. –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ health_score (ascending)
3. –í—ã–±–∏—Ä–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π score

### 3. Client Rotation (YouTube –æ–±—Ö–æ–¥)

**–ò—Å—Ç–æ—á–Ω–∏–∫:** youtube-dl INNERTUBE_CONTEXT

**–ö–ª–∏–µ–Ω—Ç—ã:**

#### WEB (Desktop browser)
```python
{
    'name': 'WEB',
    'version': '2.20250111.00.00',
    'user_agent': 'Mozilla/5.0 ... Chrome/120.0.0.0',
    'headers': {
        'Accept': 'text/html,application/xhtml+xml,...',
        'DNT': '1',
        ...
    }
}
```

#### ANDROID (Mobile app)
```python
{
    'name': 'ANDROID',
    'version': '19.09.36',
    'user_agent': 'com.google.android.youtube/19.09.36',
    'headers': {
        'Accept': '*/*',
        ...
    }
}
```

#### IOS (iPhone app)
```python
{
    'name': 'IOS',
    'version': '19.09.3',
    'user_agent': 'com.google.ios.youtube/19.09.3',
    'headers': {
        'Accept': '*/*',
        ...
    }
}
```

**–†–æ—Ç–∞—Ü–∏—è:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ cookies
- –ü–æ–º–æ–≥–∞–µ—Ç –æ–±–æ–π—Ç–∏ –¥–µ—Ç–µ–∫—Ü–∏—é –±–æ—Ç–æ–≤
- –†–∞–∑–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

### 4. Rate Limiting (–î–µ–∫–æ—Ä–∞—Ç–æ—Ä)

**–ò—Å—Ç–æ—á–Ω–∏–∫:** Hitomi-Downloader @limits

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
def rate_limit(calls: int = 1, period: float = 1.0):
    """
    –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–∏
    
    –ü—Ä–∏–º–µ—Ä: @rate_limit(calls=1, period=2.0)
    –û–∑–Ω–∞—á–∞–µ—Ç: –º–∞–∫—Å–∏–º—É–º 1 –≤—ã–∑–æ–≤ –∑–∞ 2 —Å–µ–∫—É–Ω–¥—ã
    """
    timestamps = []
    lock = Lock()
    
    def decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            with lock:
                now = time.time()
                # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ
                timestamps[:] = [t for t in timestamps if now - t < period]
                
                # –ñ–¥—ë–º –µ—Å–ª–∏ –ª–∏–º–∏—Ç –ø—Ä–µ–≤—ã—à–µ–Ω
                if len(timestamps) >= calls:
                    sleep_time = period - (now - timestamps[0])
                    if sleep_time > 0:
                        time.sleep(sleep_time)
                    timestamps.pop(0)
                
                timestamps.append(time.time())
            
            return func(*args, **kwargs)
        return wrapper
    return decorator
```

### 5. Smart Retry (–î–µ–∫–æ—Ä–∞—Ç–æ—Ä)

**–ò—Å—Ç–æ—á–Ω–∏–∫:** youtube-dl retry + Hitomi-Downloader @try_n + –Ω–∞—à–∏ —É–ª—É—á—à–µ–Ω–∏—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
def smart_retry(max_attempts=3, base_delay=1.0, backoff=2.0):
    """
    Retry —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π + jitter
    
    –ó–∞–¥–µ—Ä–∂–∫–∏: 1s ‚Üí 2s ‚Üí 4s ‚Üí 8s...
    Jitter: ¬±10% –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    """
    def decorator(func):
        @wraps(func)
        def wrapper(*args, **kwargs):
            for attempt in range(max_attempts):
                try:
                    return func(*args, **kwargs)
                except Exception as e:
                    if attempt == max_attempts - 1:
                        raise
                    
                    # –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
                    delay = base_delay * (backoff ** attempt)
                    
                    # Jitter: ¬±10%
                    jitter = random.uniform(-delay * 0.1, delay * 0.1)
                    total = delay + jitter
                    
                    print(f"Retry {attempt+1}/{max_attempts}: {e}")
                    time.sleep(total)
        return wrapper
    return decorator
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–¥–µ—Ä–∂–µ–∫:**
```
–ü–æ–ø—ã—Ç–∫–∞ 1: fail ‚Üí –∂–¥—ë–º 1.0 ¬± 0.1 = ~1.0s
–ü–æ–ø—ã—Ç–∫–∞ 2: fail ‚Üí –∂–¥—ë–º 2.0 ¬± 0.2 = ~2.0s
–ü–æ–ø—ã—Ç–∫–∞ 3: fail ‚Üí –∂–¥—ë–º 4.0 ¬± 0.4 = ~4.0s
–ü–æ–ø—ã—Ç–∫–∞ 4: success!
```

## Data Flow

### –°—Ü–µ–Ω–∞—Ä–∏–π: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ

```
1. User
   ‚îÇ download_video("https://youtu.be/VIDEO_ID")
   ‚ñº
2. ProductionYouTubeGrabber
   ‚îÇ ‚Ä¢ –ü—Ä–∏–º–µ–Ω—è–µ—Ç @rate_limit(period=3.0)
   ‚îÇ ‚Ä¢ –ü—Ä–∏–º–µ–Ω—è–µ—Ç @smart_retry(max_attempts=3)
   ‚ñº
3. ImprovedCookieManager
   ‚îÇ ‚Ä¢ get_best_cookie()
   ‚îÇ ‚Ä¢ –í—ã—á–∏—Å–ª—è–µ—Ç health_score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
   ‚îÇ ‚Ä¢ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç cookie —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º score
   ‚ñº
4. Client Config
   ‚îÇ ‚Ä¢ –í—ã–±–∏—Ä–∞–µ—Ç —Ç–µ–∫—É—â–∏–π client (WEB/ANDROID/IOS)
   ‚îÇ ‚Ä¢ –§–æ—Ä–º–∏—Ä—É–µ—Ç headers + user-agent
   ‚ñº
5. yt-dlp command
   ‚îÇ yt-dlp --user-agent "..." --cookies "account1.txt" ...
   ‚ñº
6. YouTube API
   ‚îÇ ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç cookies
   ‚îÇ ‚Ä¢ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç User-Agent
   ‚îÇ ‚Ä¢ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∏–¥–µ–æ –∏–ª–∏ –æ—à–∏–±–∫—É
   ‚ñº
7a. Success Path
    ‚îÇ ‚Ä¢ mark_usage(cookie, success=True)
    ‚îÇ ‚Ä¢ success_count += 1
    ‚îÇ ‚Ä¢ fail_count -= 1 (recovery)
    ‚îÇ ‚Ä¢ return video_path
    
7b. Failure Path (cookies blocked)
    ‚îÇ ‚Ä¢ mark_usage(cookie, success=False)
    ‚îÇ ‚Ä¢ fail_count += 1
    ‚îÇ ‚Ä¢ if fail_count >= 3: blocked = True
    ‚îÇ ‚Ä¢ rotate_client()
    ‚îÇ ‚Ä¢ @smart_retry ‚Üí –ø–æ–ø—ã—Ç–∫–∞ 2 —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
```

## Error Handling

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫

#### 1. Cookies Blocked
```python
if 'sign in' in error or 'bot' in error:
    # –î–µ–π—Å—Ç–≤–∏—è:
    ‚Ä¢ mark_usage(cookie, success=False)
    ‚Ä¢ rotate_client()
    ‚Ä¢ raise Exception("Cookies blocked")
    # @smart_retry –ø–æ–≤—Ç–æ—Ä–∏—Ç —Å –Ω–æ–≤—ã–º client
```

#### 2. Geo-Restriction
```python
if 'geo' in error or 'location' in error:
    # –î–µ–π—Å—Ç–≤–∏—è:
    ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–∫—Å–∏ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
    ‚Ä¢ raise Exception("Geo-restricted")
```

#### 3. Timeout
```python
except subprocess.TimeoutExpired:
    # –î–µ–π—Å—Ç–≤–∏—è:
    ‚Ä¢ mark_usage(cookie, success=False)
    ‚Ä¢ raise
    # @smart_retry –ø–æ–≤—Ç–æ—Ä–∏—Ç —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
```

### Auto-Recovery

**–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ cookies:**
```
Cookie A: fail=0 ‚Üí fail=1 ‚Üí fail=2 ‚Üí fail=3 ‚Üí BLOCKED ‚ùå
Cookie B: –≤—ã–±—Ä–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚úÖ
```

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:**
```
Cookie A: success ‚Üí fail_count=2
Cookie A: success ‚Üí fail_count=1  
Cookie A: success ‚Üí fail_count=0, blocked=False ‚úÖ
```

## Statistics

### Cookie Stats
```python
@dataclass
class CookieStats:
    file_path: Path
    usage_count: int
    success_count: int
    fail_count: int
    last_used: float
    blocked: bool
    
    @property
    def success_rate(self) -> float:
        return (success_count / usage_count) * 100
    
    @property
    def health_score(self) -> float:
        return usage_count * 10 + fail_count * 100
```

### Grabber Stats
```python
total_requests: int       # –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤
successful_requests: int  # –£—Å–ø–µ—à–Ω—ã—Ö
success_rate: float       # %
current_client: str       # WEB/ANDROID/IOS
```

## Configuration

### Recommended Settings

#### –†–µ–¥–∫–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ (1-10/–¥–µ–Ω—å)
```python
ProductionYouTubeGrabber(
    cookie_manager=cookie_mgr,
    client_rotation=True,
    rate_limit_calls=1,
    rate_limit_period=2.0,  # 2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
)
```

#### –£–º–µ—Ä–µ–Ω–Ω—ã–µ (10-50/–¥–µ–Ω—å)
```python
ProductionYouTubeGrabber(
    cookie_manager=cookie_mgr,
    client_rotation=True,
    rate_limit_calls=1,
    rate_limit_period=3.0,  # 3 —Å–µ–∫—É–Ω–¥—ã
)
```

#### –ú–∞—Å—Å–æ–≤—ã–µ (50+/–¥–µ–Ω—å)
```python
ProductionYouTubeGrabber(
    cookie_manager=cookie_mgr,
    client_rotation=True,
    rate_limit_calls=1,
    rate_limit_period=5.0,  # 5 —Å–µ–∫—É–Ω–¥ + –ø—Ä–æ–∫—Å–∏
)
```

## Performance

### Benchmarks

**–ë–µ–∑ —Ä–µ—à–µ–Ω–∏—è:**
- Success rate: ~20%
- Cookie lifetime: 10-15 –º–∏–Ω—É—Ç
- –¢—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞

**–° —Ä–µ—à–µ–Ω–∏–µ–º V2:**
- Success rate: >80%
- Cookie lifetime: –¥–Ω–∏/–Ω–µ–¥–µ–ª–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### Bottlenecks

1. **Rate Limiting** - –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ (–∑–∞—â–∏—Ç–∞ –æ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)
2. **Cookie rotation** - O(1) –∑–∞ —Å—á—ë—Ç health_score
3. **Client rotation** - O(1) —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥

## Testing

### Unit Tests
```bash
python test_youtube_bypass.py
```

**–¢–µ—Å—Ç—ã:**
1. –û–¥–∏–Ω cookies —Ñ–∞–π–ª
2. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ cookies (—Ä–æ—Ç–∞—Ü–∏—è)
3. –ü—Ä–æ–∫—Å–∏ + cookies
4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ

### Integration Test
```python
grabber = ProductionYouTubeGrabber(...)

# Test 1: Metadata
metadata = grabber.get_metadata("https://youtu.be/jNQXAC9IVRw")
assert metadata['title'] == 'Me at the zoo'

# Test 2: Download
video = grabber.download_video("https://youtu.be/jNQXAC9IVRw")
assert video.exists()

# Test 3: Stats
grabber.print_stats()
assert grabber.successful_requests > 0
```

## Future Improvements

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1
- [ ] Async/await –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫
- [ ] Prometheus metrics —ç–∫—Å–ø–æ—Ä—Ç
- [ ] Web UI –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2
- [ ] CloudFlare bypass (clf2)
- [ ] CAPTCHA —Ä–µ—à–µ–Ω–∏–µ
- [ ] –ü—Ä–æ–∫—Å–∏ —Ä–æ—Ç–∞—Ü–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3
- [ ] Machine Learning –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- [ ] Distributed cookie pool
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

## Maintenance

### –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏

**–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:**
```bash
# –û–±–Ω–æ–≤–∏—Ç—å cookies
./cookie_manager.py stats
./cookie_manager.py unblock
```

**–ï–∂–µ–º–µ—Å—è—á–Ω–æ:**
```bash
# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ
./cookie_manager.py clean --days 30

# –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
./cookie_manager.py add --file new_cookies.txt
```

**–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health
./cookie_manager.py stats

# –ï—Å–ª–∏ success_rate < 50%:
# 1. –û–±–Ω–æ–≤–∏—Ç—å cookies
# 2. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
# 3. –í–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–∫—Å–∏
```

## Conclusion

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –ª—É—á—à–∏—Ö –ø—Ä–∞–∫—Ç–∏–∫–∞—Ö –∏–∑:
- ‚úÖ youtube-dl (120K+ stars)
- ‚úÖ Hitomi-Downloader (23K+ stars)
- ‚úÖ –ù–∞—à–∏ —É–ª—É—á—à–µ–Ω–∏—è –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏

–†–µ–∑—É–ª—å—Ç–∞—Ç: **Production-ready —Ä–µ—à–µ–Ω–∏–µ** —Å >80% success rate.
